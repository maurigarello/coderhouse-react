<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <link rel="icon" href="%PUBLIC_URL%/favicon.ico" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="theme-color" content="#000000" />
  <meta name="description" content="Proyecto personal de Mauricio Garello Front End Developer" />
  <link rel="manifest" href="%PUBLIC_URL%/manifest.json" />

  <title>MauriMart</title>

  <!--Gorgias Chat Widget Start-->
  <script id="gorgias-chat-widget-install-v3"
    src="https://config.gorgias.chat/bundle-loader/01JP0GA2TREFS4WPP7W4R20VC5">
    </script>
  <!--Gorgias Chat Widget End-->

  <script>
    (async function () {
      if (!window.GorgiasChat) {
        // wait for the widget to load if it's not already available
        await new Promise(resolve =>
          window.addEventListener('gorgias-widget-loaded', resolve, { once: true })
        );
      }
      // initialize the chat SDK
      await window.GorgiasChat.init();

      // WCAG: on open, swap out any <h1> for <span>
      window.GorgiasChat.on('open', () => {
        const root = document.querySelector('#gorgias-chat-container');
        console.log(root);
        if (!root) return;
        root.querySelectorAll('h1').forEach(h1 => {
          const span = document.createElement('span');
          span.className = h1.className;
          span.textContent = h1.textContent;
          h1.replaceWith(span);
        });
      });

      const timer = setInterval(() => {
        const container = document.querySelector('#gorgias-chat-container');
        const iframe = container?.querySelector('#chat-button');
        const head = iframe?.contentWindow?.document.querySelector('head');
        if (!head?.children.length) return;
        clearInterval(timer);

        // hide the original iframe button
        iframe.style.display = 'none';

        // create our custom button
        const myButton = document.createElement('button');
        myButton.id = 'gorgias-chat-messenger-button';
        myButton.setAttribute('data-testid', 'gorgias-chat-messenger-button');
        myButton.setAttribute('aria-label', 'Open gorgias live chat');
        myButton.className = 'messenger-button-iframe-1tx54w6 fade-in-up-appear-done fade-in-up-enter-done';

        // insert SVG icons and label
        myButton.innerHTML = `
        <div class="messenger-button-iframe-hra7aq" style="margin-right: 10px;">
          <!-- chat icon -->
          <svg width="28" height="28" viewBox="0 0 100 100" fill="none" role="img"
               xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
            <!-- filter and path omitted for brevity -->
          </svg>
        </div>
        <div class="messenger-button-iframe-9e5ujv" style="margin-right: 10px;">
          <!-- dropdown arrow icon -->
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none"
               role="img" viewBox="0 0 24 24" aria-hidden="true">
            <!-- path omitted for brevity -->
          </svg>
        </div>
        <span color="#161616" class="messenger-button-iframe-bzxdgz">Chatte mit uns</span>
      `;

        // grab both icon containers
        const svgChat = myButton.querySelector('.messenger-button-iframe-hra7aq');
        const svgArrow = myButton.querySelector('.messenger-button-iframe-9e5ujv');

        // show only the chat icon initially
        svgChat.style.display = 'flex';
        svgArrow.style.display = 'none';

        // Apply styles to the button
        Object.assign(myButton.style, {
          '--main-font-family': '"Inter"',
          '--focus-color': '#3BB9FF',
          colorScheme: 'light',
          fontFamily: 'var(--main-font-family),Inter,"Helvetica Neue",Helvetica,Arial,sans-serif',
          lineHeight: '20px',
          cursor: 'pointer',
          display: 'inline-flex',
          WebkitBoxAlign: 'center',
          alignItems: 'center',
          position: 'fixed',
          background: '#ebebeb',
          border: '3px solid transparent',
          borderRadius: '100px',
          boxShadow: 'rgba(22, 22, 22, 0.16) 0px 2px 4px',
          height: '60px',
          margin: '7px 10px',
          padding: '16px 20px',
          bottom: '24px',
          right: '24px'
        });

        // toggle Chat widget state and swap icons on click
        myButton.addEventListener('click', () => {
          if (window.GorgiasChat.isOpen()) {
            // close the chat widget if it's open
            window.GorgiasChat.close();
          } else {
            // open the chat widget if it's closed
            window.GorgiasChat.open();
          }
          // swap icon visibility
          if (svgChat.style.display !== 'none') {
            svgChat.style.display = 'none';
            svgArrow.style.display = 'flex';
          } else {
            svgChat.style.display = 'flex';
            svgArrow.style.display = 'none';
          }
        });

        document.body.appendChild(myButton);
      }, 50);
    })();
  </script>

  <!--Bundle Start-->
  <script src="https://bundle.dyn-rev.app/loader.js?g_cvt_id=7db25a73-df8b-485e-a91a-81609afe3309" async></script>
  <!--Bundle End-->
  <div id="root"></div>
  </body>

</html>
